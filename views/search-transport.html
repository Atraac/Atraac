<div class="ui container" data-ng-controller="SearchTransportController">
    <div class="ui grid stackable">
        <form class="ui form" name="searchTransportsForm" data-ng-submit="onSearch()" novalidate>
            <div class="column">
                <h4 class="ui horizontal divider header">
                    <i class="Shipping icon"></i>
                    Wyszukiwanie
                </h4>
                <div class="ui grid stackable">
                    <div class="row">
                        <div class="five wide column">
                        </div>
                        <div class="six wide column">
                            <ul>
                                <li class="has-error" data-ng-show="searchTransportsForm.sourceCity.$invalid && searchTransportsForm.sourceCity.$touched" class="help-block">Miasto startowe jest wymagane</li>
                                <li class="has-error" data-ng-show="searchTransportsForm.destinationCity.$invalid && searchTransportsForm.destinationCity.$touched" class="help-block">Miasto docelowe jest wymagane</li>
                                <li class="has-error" data-ng-show="searchTransportsForm.departureDate.$invalid && searchTransportsForm.departureDate.$touched" class="help-block">Data wyjazdu jest wymagana</li>
                                <li class="has-error" data-ng-show="missedSelection">Wybierz co najmniej jedną preferencję paczki</li>
                            </ul>
                        </div>
                        <div class="five wide column">
                        </div>
                    </div>
                    <div class="row">
                        <div class="five wide column">
                        </div>
                        <div class="four wide column">
                            <div class="field" data-ng-class="{'error' : searchTransportsForm.sourceCity.$invalid && searchTransportsForm.sourceCity.$touched }">
                                <label><i class="Flag Outline icon"></i>Miasto początkowe</label>
                                <select id="sourceCity" name="sourceCity" data-ng-model="searchTransport.sourceCity" data-ng-options="sourceCity.name for sourceCity in cities" required>
                                </select>
                            </div>
                            <div class="field" data-ng-class="{'error' : searchTransportsForm.destinationCity.$invalid && searchTransportsForm.destinationCity.$touched }">
                                <label><i class="Flag icon"></i>Miasto docelowe</label>
                                <select id="destinationCity" name="destinationCity" data-ng-model="searchTransport.destinationCity" data-ng-options="sourceCity.name for sourceCity in cities" required>
                                </select>
                            </div>
                            <div class="field" data-ng-class="{'error' : searchTransportsForm.departureDate.$invalid && searchTransportsForm.departureDate.$touched }">
                                <label><i class="Calendar icon"></i>Data nadania paczki</label>
                                <input data-ng-model="departureDate" id="departureDate" type="text" name="departureDate" readonly="readonly" required>
                            </div>

                        </div>
                        <div class="three wide column">
                            <div class="grouped fields">
                                <label><i class="Suitcase icon"></i>Akceptowane paczki</label>
                                <div class="field">
                                    <div style="display: block; margin-bottom: 5px" class="ui slider checkbox" data-ng-repeat="preference in preferences">
                                        <input
                                                type="checkbox"
                                                name="selectedPreferences[]"
                                                value="{{preference.id}}"
                                                data-ng-checked="selection.indexOf(preference) > -1"
                                                data-ng-click="toggleSelection(preference)"
                                        >
                                        <label>{{preference.name}}</label>
                                    </div>
                                </div>
                            </div>
                            <div class="field">
                                <button data-ng-disabled="searchTransportsForm.$invalid" class="ui left floated large accent-color button" type="submit">Wyszukaj</button>
                            </div>
                        </div>
                        <div class="four wide column">
                        </div>
                    </div>
                    <div class="row">
                        <div class="five wide column">
                        </div>
                        <div class="six wide column">
                            <div class="ui orange segment center aligned" data-ng-show="searchNotFound">
                                Nie znaleziono przejazdów dla zadanych parametrów
                            </div>
                            <div class="ui red segment center aligned" data-ng-show="getTransportsError">
                                Błąd połączenia z serwerem
                            </div>
                        </div>
                        <div class="five wide column">
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div id="searchResults" data-ng-show="searchResults">
        <h4 class="ui horizontal divider header">
            <i class="Shipping icon"></i>Wyszukane przejazdy
        </h4>
        <div class="ui grid centered">
            <div class="row">
                <div class="ui form">
                    <div class="field">
                        <label><i class="Sort icon"></i>Sortuj według</label>
                        <select name="sortBy" id="sortBy">
                            <option value="BYDATEASC">Daty - rosnąco</option>
                            <option value="BYDATEDESC">Daty - malejąco</option>
                            <option value="BYDRIVERRATINGASC">Oceny - rosnąco</option>
                            <option value="BYDRIVERRATINGDESC">Oceny - malejąco</option>
                            <option value="BYPRICEASC">Ceny - rosnąco</option>
                            <option value="BYPRICEDESC">Ceny - malejąco</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row">
                <i class="Big Angle Left icon" data-ng-click="searchPrevious()" style="cursor: hand;"></i>
                <label>  Strona {{pageNumber}} z {{totalPages}}  </label>
                <i class="Big Angle Right icon" data-ng-click="searchNext()" style="cursor: hand;"></i>
            </div>
        </div>
        <div class="ui grid centered">
            <table class="ui very basic collapsing celled table">
                <thead>
                <tr>
                    <th>
                        Kierowca
                    </th>
                    <th>
                        Tytuł
                    </th>
                    <th>
                        Trasa
                    </th>
                    <th>
                        Czas wyjazdu
                    </th>
                    <th>
                        Rodzaje paczek
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr data-ng-repeat="transport in transports ">
                    <td>
                        <h4 class="ui image header">
                            <i class="user icon"></i>
                            <div class="content">
                                <a class="accent-color-link" type="button" href="#/profile/{{transport.driver.id}}">{{transport.driver.name}} {{transport.driver.surname}}</a>
                                <p></p><rating id="my-rating{{transport.id}}" size="small" type="star" data-ng-model="transport.driver.rating"></rating></p>
                                <p>
                                    <div data-ng-show="(transport.driver.rating <= 0)" class="sub header">Ocena: Brak ocen</div>
                                    <div data-ng-show="(transport.driver.rating > 0)" class="sub header">Ocena: {{transport.driver.rating}}</div>
                                </p>
                            </div>

                        </h4>
                    </td>
                    <td>
                        <h4><a class="accent-color-link" href="#/transports/{{transport.id}}" type="button">{{transport.title}}</a></h4>
                    </td>
                    <td>
                        Z: {{transport.cities[0].city.name}}  Do: {{transport.cities[transport.cities.length - 1].city.name}}
                    </td>
                    <td>
                        {{transport.departureDate | date: 'short'}}
                    </td>
                    <td>
                    <span data-ng-repeat="preference in transport.preferences">
                        {{preference.name}}
                    </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="ui grid centered">
            <i class="Big Angle Left icon" data-ng-click="searchPrevious()" style="cursor: hand;"></i>
            <label>  Strona {{pageNumber}} z {{totalPages}}  </label>
            <i class="Big Angle Right icon" data-ng-click="searchNext()" style="cursor: hand;"></i>
        </div>
    </div>
</div>
</div>
