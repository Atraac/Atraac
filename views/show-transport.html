<div class="ui container" data-ng-controller="ShowTransportController">
    <div data-ng-if="error" class="ui centered card red">
            <div class="content center aligned">
                <div class="header">
                    Przykro mi! :(
                </div>
                <div class="description">
                    Nie ma takiego transportu.
                </div>
            </div>
    </div>
    <div data-ng-if="!error" class="ui grid stackable">
        <div class="four wide column center aligned">
            <div class="row">
                <h4 class="ui horizontal divider header">
                    <i class="user icon"></i>
                    Kierowca
                </h4>
                <div class="grow">
                    <a href="#/profile/{{transport.driver.id}}">
                        <div class="ui header">
                            <rating id="my-rating" size="large" type="star" data-ng-model="transport.driver.rating | round"></rating>
                            <span>{{transport.driver.rating}}</span>
                        </div>
                        <img data-ng-click="" class="profile-image image center ui tiny" src="./content/pictures/brak.jpg">
                        <div class="description">
                            <p>Imię: <strong>{{transport.driver.name}}</strong></p>
                            <p>Nazwisko: <strong>{{transport.driver.surname}}</strong></p>
                            <p>Auto: <strong>{{transport.driver.car}}</strong></p>
                            <p>Telefon: <strong>{{transport.driver.phoneNumber}}</strong></p>
                        </div>
                    </a>
                </div>
            </div>
            <div class="row ">
                <h4 class="ui horizontal divider header">
                    <i class="Calendar icon"></i>
                    Termin wyjazdu
                </h4>
                <h4>
                    {{transport.departureDate | date:'short'}}
                </h4>
            </div>
        </div>
        <div class="four wide column center aligned">
            <div class="row">
                <h4 class="ui horizontal divider header">
                    <i class="Road icon"></i>
                    Trasa
                </h4>
                <div class="ui list">
                    <div class="item" data-ng-repeat="city in transport.cities">
                        <p data-ng-show="$first" ><i class="Flag Outline icon"></i><strong>{{city.city.name}}</strong></p>
                        <p data-ng-show="$middle" ><i class="Arrow Down icon"></i>{{city.city.name}}</p>
                        <p data-ng-show="$last" ><i class="Flag icon"></i><strong>{{city.city.name}}</strong></p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="four wide column center aligned ">
                    <h4 class="ui horizontal divider header">
                        <i class="Dropbox icon"></i>
                        Typ paczek
                    </h4>
                    <div class="ui list">
                        <div class="item" data-ng-repeat="type in transport.preferences">
                            <p><i class="Cube icon"></i>{{type.name}}</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="eight wide column center aligned">
            <div class="row">
                <h4 class="ui horizontal divider header">
                    <i class="Write icon"></i>
                    Opis
                </h4>
                <div>
                    <h4>{{transport.title}}</h4>
                    {{transport.description}}
                </div>
            </div>
            <div class="row ">
                <h4 class="ui horizontal divider header">
                    <i class="Heartbeat icon"></i>
                    Akcje/Stan
                </h4>
                <div data-ng-if="userIsDriver">
                    <div class="ui grid centered">
                        <table class="ui very basic collapsing celled table">
                            <thead>
                                <tr>
                                    <th>Imię Nazwisko</th>
                                    <th>Typy paczek</th>
                                    <th>Stan</th>
                                    <th>Akcje</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-ng-repeat="reservation in transport.reservations">
                                    <td>
                                        <h4>
                                            <a class="accent-color-link" href="#/profile/{{reservation.sender.id}}">
                                                {{reservation.sender.name}} {{reservation.sender.surname}}
                                            </a>
                                        </h4>
                                    </td>
                                    <td>
                                        <span data-ng-repeat="preference in reservation.preferences">
                                            {{preference.name}}
                                        </span>
                                    </td>
                                    <td>
                                        <div data-ng-if="reservation.state==='ACCEPTED'">
                                            <i class="Checkmark green large icon"></i>
                                        </div>
                                        <div data-ng-if="reservation.state==='REJECTED'">
                                            <i class="remove red large icon"></i>
                                        </div>
                                        <div data-ng-if="reservation.state==='NOTACCEPTED'">
                                            <i class="Help grey large icon"></i>
                                        </div>
                                    </td>
                                    <td>
                                        <div data-ng-if="reservation.state==='NOTACCEPTED'" class="two ui buttons">
                                            <button data-ng-click="acceptReservation(reservation.id)" class="ui reservation green basic button">
                                                Zaakceptuj
                                            </button>
                                            <button data-ng-click="rejectReservation(reservation.id)" class="ui reservation red basic button">
                                                Odrzuć
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div data-ng-if="!userIsDriver && userReservation!=null">
                    <div class="ui Yellow segment" data-ng-if="userReservation.state==='NOTACCEPTED'">
                        Twoja rezerwacja oczekuje na decyzję kierowcy
                    </div>
                    <div class="ui Green segment" data-ng-if="userReservation.state==='ACCEPTED'">
                        Twoja rezerwacja została zaakceptowana przez kierowcy
                    </div>
                    <div class="ui Red segment" data-ng-if="userReservation.state==='REJECTED'">
                        Twoja rezerwacja została odrzucona przez kierowcę
                    </div>
                </div>
                <div data-ng-if="!userIsDriver && userReservation==null && transport.state === 'OPENED'">
                        <p>Można zarejestrować paczkę</p>
                        <div data-ng-click="onModalReservation()" class="ui  large accent-color button" type="button">Zarezerwuj</div>
                </div>
            </div>
        </div>
    </div>

    <div id="acceptReservationModal" class="ui basic modal">
        <i data-ng-click="acceptReservationModalCancel()" class="close icon"></i>
        <div class="header">
            Potwierdzenie
        </div>
        <div class="image content">
            <i class="Check Circle Outline huge icon"></i>
            <div class="description white-description">
                <h4>Czy napewno chcesz potwierdzić tą rezerwację?</h4>
                <h4>Potem nie będzie odwrotu!</h4>
            </div>
        </div>
        <div class="actions">
            <div class="two fluid ui inverted buttons">
                <div data-ng-click="acceptReservationModalOK()" class="ui green basic inverted button">
                    <i class="checkmark icon"></i>
                    Tak
                </div>
                <div data-ng-click="acceptReservationModalCancel()" class="ui red basic inverted button">
                    <i class="remove icon"></i>
                    Nie
                </div>
            </div>
        </div>
    </div>

    <div id="rejectReservationModal" class="ui basic modal">
        <i data-ng-click="rejectReservationModalCancel()" class="close icon"></i>
        <div class="header">
            Potwierdzenie
        </div>
        <div class="image content">
            <i class="Remove Circle Outline huge icon"></i>
            <div class="description white-description">
                <h4>Czy napewno chcesz odrzucić tą rezerwację?</h4>
                <h4>Potem nie będzie odwrotu!</h4>
            </div>
        </div>
        <div class="actions">
            <div class="two fluid ui inverted buttons">
                <div data-ng-click="rejectReservationModalOK()" class="ui green basic inverted button">
                    <i class="checkmark icon"></i>
                    Tak
                </div>
                <div data-ng-click="rejectReservationModalCancel()" class="ui red basic inverted button">
                    <i class="remove icon"></i>
                    Nie
                </div>
            </div>
        </div>
    </div>

    <div id="addReservationModal" class="ui small modal">
        <i data-ng-click="closeModal()" class="close icon"></i>
        <div data-ng-if="!correctReservation && error" class="header">
            Nie udało się! Jakiś błąd serwera :(
        </div>
        <div data-ng-if="!correctReservation && !error" class="header">
            Zarezerwuj paczkę!
        </div>
        <div data-ng-if="correctReservation && !error" class="header">
            Pomyślna rezerwacja!
        </div>
        <div data-ng-if="correctReservation && !error" class="content">
            Teraz czekaj na zaakceptowanie twojej rezerwacji przez kierowcę.
            Możesz sprawdzić status rezerwacji w szczegółach transportu oraz w zakładce "Twoje przesyłki".
        </div>
        <div data-ng-if="!correctReservation && !error" class="content">
            <form class="ui form" name="reservationForm" data-ng-submit="onReservation()" novalidate>
                <div class="ui grid center stackable">
                    <div class="two wide column"></div>
                    <div class="six wide column">
                        <div data-ng-if="noPreference" div class="row">
                            <ul>
                                <li class="has-error">Podaj chociaż jedną preferencję</li>
                            </ul>
                        </div>
                        <div class="row">
                            <div class="grouped fields">
                                <label><i class="Suitcase icon"></i>Jakie są twoje paczki?</label>
                                <div class="field">
                                    <div style="display: block; margin-bottom: 5px" class="ui slider checkbox" data-ng-repeat="preference in preferences">
                                        <input
                                                type="checkbox"
                                                name="selectedPreferences[]"
                                                value="{{preference.id}}"
                                                data-ng-checked="reservation.preferences.indexOf(preference) > -1"
                                                data-ng-click="toggleSelection(preference)"
                                        >
                                        <label>{{preference.name}}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="six wide column">
                        <div class="row">
                            <div class="field" data-ng-class="{'error' : reservationForm.receiverEmail.$invalid && reservationForm.receiverEmail.$touched }">
                                <label><i class="at icon"></i>(Opcjonalnie) Email odbiorcy: </label>
                                <input data-ng-model="reservation.receiverEmail" type="email" name="receiverEmail">
                            </div>
                        </div>
                        <div class="row">
                            <div style="margin-top: 10px" class="row">
                                <div class="two ui buttons">
                                    <button data-ng-disabled="reservationForm.$invalid" class="ui green basic button" type="submit">
                                        Zarezerwuj
                                    </button>
                                    <button data-ng-click="closeModal()" class="ui red basic button">
                                        Cofnij
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="two wide column"></div>
                </div>
            </form>
        </div>
    </div>
</div>